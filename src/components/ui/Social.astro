---
import { Icon } from "astro-icon/components";

export interface Props {
  socials?: { name: string; url: string; icon: string }[];
}

const { socials } = Astro.props;

const formatSocialName = (name: string): string => {
  const nameMap: Record<string, string> = {
    github: "GitHub",
    linkedin: "LinkedIn",
    x: "X (Twitter)",
  };
  return nameMap[name] || name.charAt(0).toUpperCase() + name.slice(1);
};
---

{
  socials && (
    <div class="flex flex-row gap-8 lg:gap-20">
      {socials.map((social) => (
        <a
          href={social.url}
          target="_blank"
          rel="noopener"
          aria-label={`Odwiedź mój profil na ${formatSocialName(social.name)}`}
          data-social-name={social.name}
          class="social-link inline-flex min-h-[44px] min-w-[44px] items-center justify-center transition-all duration-150 active:scale-95 motion-reduce:transition-none motion-reduce:active:scale-100"
        >
          <Icon
            class="h-8 hover:text-orange dark:hover:text-orange md:h-12 transition-colors duration-150 motion-reduce:transition-none"
            name={social.icon}
            size={48}
          />
        </a>
      ))}
    </div>
  )
}

<script>
  import { track, TrackingEvents, onReady } from "@lib/tracking";

  onReady(() => {
    const socialLinks = document.querySelectorAll(".social-link[data-social-name]");
    socialLinks.forEach((link) => {
      if (!link.hasAttribute("data-tracking-initialized")) {
        link.setAttribute("data-tracking-initialized", "true");
        link.addEventListener("click", () => {
          const name = link.getAttribute("data-social-name");
          if (name) {
            track(TrackingEvents.SOCIAL_LINK_CLICKED, { Name: name });
          }
        });
      }
    });
  });
</script>
